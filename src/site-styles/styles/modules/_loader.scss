/*
  Loader

  January 1, 2017
  ask sorenfrederiksen@fairfaxmedia.com.au

  A loading indicator featuring a masthead-appropriate logo initial.

  To use this loader style, add this to the top of your HTML document (or add the symbol elements to 
  an existing svg container):

  ```
  <svg xmlns="http://www.w3.org/2000/svg" style="position:absolute; width: 0; height: 0;">
    <symbol viewBox="0 0 50 60" id="icon-loading-ct">
      <path d="M18.244 19.205L16.378 20.5l-1.072-1.296L39.152 0c.285 1.58 1.219 6.812 4.092 6.31 2.152-.364 4.166-3.013 5.32-4.73H50c-.65 2.008-1.363 3.79-2.662 5.515-1.293 1.653-2.802 3.014-4.524 4.156-1.29.867-2.298 1.361-3.807 1.79l-.073 34.255c.787-.639 1.51-1.28 2.151-2.073 1.372-1.507 2.38-3.224 3.45-4.876l1.154.428c-1.226 3.37-2.445 6.813-4.669 9.745-2.37 3.085-5.675 6.1-9.273 7.67-2.508 1.151-6.033 1.653-8.76 1.79C12.138 60.418 3.158 53.324.86 42.786A42.985 42.985 0 0 1 0 34.182c.073-4.722 2.014-9.38 4.376-13.397 3.378-5.872 8.842-10.538 15.022-13.471 2.444-1.15 5.31-2.22 8.111-2.22.293 0 .723.066.861.35.073.145-.064.363-.21.363-2.729 1.07-3.306 1.143-5.815 2.795-2.452 1.645-4.815 3.37-6.617 5.662-4.523 5.59-5.886 12.968-5.1 20 .365 3.215 1.438 6.438 3.24 9.16 1.218 1.799 2.801 3.16 4.376 4.52v-28.74zm3.622 29.331c2.444 1.15 4.816 2.3 7.543 2.3 1.73.066 3.662 0 5.318-.648.577-.29 1.143-.712 1.721-1.077l.074-36.977-4.313-3.013-1.217 25.515c-.074 2.51-1.145 4.95-2.37 7.096-1.007 1.725-2.59 3.15-4.094 4.448-.86.72-1.72 1.506-2.662 2.356z" fill="#0A1633" fill-rule="evenodd"/>
    </symbol>
    <symbol viewBox="0 0 59 62" id="icon-loading-smh">
      <path d="M44.28 48.294c-4.229-3.036-9.12-5.265-13.698-6.539l-.124-.041 5.043-7.53c6.429 1.401 10.814 4.95 10.814 8.611 0 1.632-.746 3.81-1.975 5.418l-.06.08zM32.557 23.685c-.886-.123-3.722-.609-4.415-.766-2.306-.477-13.809-3.888-13.809-8.981 0-5.786 7.435-5.786 11.005-5.786.788 0 9.162.732 13.111 6.18-.041.078-4.838 7.711-5.892 9.353zm25.235-7.84l.115-.094c.566-.544 1.093-1.66 1.093-2.327 0-.776-.285-1.484-.799-2-.497-.565-1.268-.885-2.288-.96-.087-.006-.584-.03-.617-.03-2.5.024-5.195 1.598-8.038 4.36-2.497 2.425-3.438 4.221-5.015 6.71-1.28 2.024-1.892 2.98-2.235 3.528-.481-.06-3.38-.518-5.976-1.083.836-1.36 3.303-5.693 6.102-9.745 2.035-2.945 4.496-5.61 5.73-7.129.193-.236.38-.375.605-.502.168-.095.417-.22.5-.315.009-.113-.327-.447-.385-.49-.166.022-.265.06-.405.129-.191.09-.447.215-.801.215-.451 0-.916-.384-1.761-1.083C41.495 3.27 37.543.012 30.598 0 18.702-.018 11.679 10.125 11.767 16.839c.055 4.183.854 8.78 2.94 10.712 2.128 1.97 5.712 3.41 11.98 4.9l.421.11-1.005 1.117c-1.649 1.405-2.834 2.755-5.925 2.831-1.955 0-2.866-.669-3.566-1.296l-.147.062c.163.329.59 1.063 1.14 1.739.704.857 1.35 1.306 1.93 1.336.095.025.914.234 2.238-.179 1.71-.534 3.556-1.817 5.338-3.824l.688-.771.69-.769 4.475.799c.511.116 1.015.173 1.457.303l-1.843 2.806c-2.325 3.51-3.214 4.605-3.214 4.605s-1.551-.224-1.96-.303c-1.276-.255-3.283-.382-6.06-.359-5.432-.05-12.938 1.959-17.463 6.469a13.529 13.529 0 0 0-2.288 2.996A11.737 11.737 0 0 0 0 56.078C0 58.81 1.798 62 6.876 62c6.794 0 12.706-6.42 15.824-9.872l.5-.556c.928-1.019 1.353-1.732 1.692-2.095 3.593.995 9.43 3.433 14.54 6.786 1.038-1.058 4.088-4.69 6.947-8.944 1.568-2.334 5.184-7.758 5.313-11.921.126-3.987-3.603-8.775-10.497-10.197.221-.458.633-1.162 1.667-2.762 2.834-4.392 5.39-8.96 10.78-8.96.964 0 2.969.22 4.055 2.24.032.046.05.076.095.127zM17.445 55.863c-1.312 1.119-2.63 2.065-3.922 2.816-1.358.747-2.686 1.296-4.021 1.63a11.6 11.6 0 0 1-2.799.38c-.256 0-.516-.015-.822-.042-2.755-.271-4.47-1.906-4.47-4.277 0-6.279 10.526-8.23 14.361-8.23l.808-.005c1.756-.014 2.985.111 6.431.806l.723.192a46.746 46.746 0 0 1-5.011 5.552c-.435.407-.84.806-1.278 1.178z" fill="#0A1633" fill-rule="evenodd"/>
    </symbol>
    <symbol viewBox="0 0 60 41" id="icon-loading-watoday">
      <path d="M29.974 11.33h-.334c-.611 1.626-10.344 27.707-10.566 28.269-.22.618-.5 1.401-1.389 1.401-.611 0-.946-.449-1.167-1.12L4.007 4.318C3.45 2.746 2.448 2.297 1.725 2.297H.335C.055 2.297 0 2.074 0 1.85V.392C0 .112.056 0 .445 0c.445 0 2.17.166 7.897.166C12.347.166 14.624 0 15.18 0c.389 0 .446.166.446.447V1.85c0 .28-.057.447-.446.447h-1.223c-.89 0-1.446.788-1.112 1.91l7.62 24.453h.331c.668-1.906 7.34-19.744 7.34-21.763 0-1.403-.556-2.86-1.053-3.53-.502-.675-1.225-1.07-1.67-1.07h-1.112c-.279 0-.335-.113-.335-.447V.392c0-.226.056-.392.39-.392.502 0 2.449.166 7.34.166 4.67 0 6.784-.166 7.34-.166.334 0 .386.166.386.502v1.403c0 .224-.052.392-.385.392h-1.67c-.889 0-1.39 1.235-1.11 2.189l7.673 24.174h.333c2.728-7.627 7.564-21.874 7.564-24.904 0-.617-.723-1.459-1.78-1.459h-1.612c-.335 0-.392-.168-.392-.504v-1.4c0-.227.057-.393.446-.393.555 0 2.504.166 5.95.166C57.555.166 59.167 0 59.61 0c.336 0 .389.111.389.502v1.403c0 .224 0 .392-.389.392h-1.054c-.946 0-2.058.62-2.614 2.02-.668 1.796-11.846 32.252-12.958 34.946-.277.673-.667 1.737-1.669 1.737-.779 0-1.11-.728-1.389-1.51l-9.953-28.16" fill="#0A1633" fill-rule="evenodd"/>
    </symbol>
    <symbol viewBox="0 0 61 56" id="icon-loading-theage">
      <path d="M55.49 51.65a76.398 76.398 0 0 1-3.368-6.912L32.98 0h-4.86L16.7 28.195c-1.56 3.883-9.118 21.282-10.102 23.07-1.2 2.15-2.076 1.862-6.598 2.25V56c1.642-.077 6.268-.232 9.143-.232 2.547 0 5.093.155 7.394.232v-2.486c-6.16-.077-6.736-.387-6.736-1.24 0-.312.33-1.244.74-2.332l4.503-11.435c.494-1.165.741-1.398 1.808-1.398h18.65c1.481 0 1.645 0 2.137 1.165l4.953 12.367c.328.776.575 1.475.575 1.941 0 .39-.575.778-7.394.932V56c6.407-.154 9.2-.232 12.242-.232 4.435 0 9.37.078 12.985.232v-2.64c-3.184 0-4.771-.388-5.51-1.71zM35.61 34.391c0 .233-.411.466-.984.544H18.151c-1.151 0-1.48-.233-1.48-.466s.166-.544.329-1.088l8.973-22.253c.246-.466.33-.854.494-.854.162 0 .41.388.493.7l.047.116 8.274 22.291c.245.622.328.777.328 1.01z" fill="#0A1633" fill-rule="evenodd"/>
    </symbol>
    <symbol viewBox="0 0 47 62" id="icon-loading-bt">
      <path d="M25.33 53.374c-3.825 0-7.729-1.627-10.519-5.29V33.278c2.312-4.556 6.774-6.51 10.678-6.51 7.17 0 11.712 6.349 11.712 13.183 0 6.427-3.824 13.424-11.872 13.424m1.99-35.23c-4.38 0-9.479 1.79-12.508 5.776V0H0v8.782l5.172.34v51.9h8.764l.48-4.882C17.44 60.21 22.698 62 27.162 62 38.873 62 47 51.666 47 40.193c0-12.285-8.445-22.048-19.68-22.048" fill="#0A1633" fill-rule="evenodd"/>
    </symbol>
  </svg>
  ```
  You can then use the button style as follows.

  Your SCSS:
  ```
  .elementContainingYourLoaderClass {
    position: relative;
  }

  .yourLoaderClass {
    @include loader("standard");
  }
  ```
  Your HTML:
  ```
  <div class="yourLoaderClass">
    <div class="loader-icon">
      <div class="loader-icon__borders-container">
        <div class="loader-icon__borders-container__borders"></div>   
      </div>
      <svg 
        viewBox="0 0 60 60" version="1.1" 
        xmlns="http://www.w3.org/2000/svg"
        class="loader-icon__svg">
        <use 
          xmlns:xlink="http://www.w3.org/1999/xlink" 
          xlink:href="#icon-loading-smh" 
          class="loader-icon__svg__image" >
      </svg>
    </div>
    <p class="loader-message">
      Some default message.
    </p>
    <div class="loader-retry">
      <button class="loader-retry__button">
        Try again
      </button>
    </div>
  </div>

  ```
*/

// *---> Private mix-ins

/*
  Loader

  @param { Number with unit } icon-side-length - Length of the side of the loading icon to be displayed
  @param { Color } icon-color - Color of the loading icon
  @param { Color } inner-border-color - Color of the inner spinning border
  @param { Color } outer-border-color - Color of the outer spinning border
  @param { color } text-color - Color of the loading text
*/

@mixin _loader(
  $icon-side-length: 80px,
  $icon-color: $color__blue-zodiac,
  $inner-border-color: $color__aluminium,
  $outer-border-color: $color__blue-zodiac,
  $text-color: $color__mine-shaft,
  $button-size: "medium",
  $button-size-rules: "dynamic", 
  $button-style: "hollow",
  $button-can-load: false) {

  $loader-bezier: cubic-bezier(0.41, 0.12, 0.36, 0.95);

  display: block;

  position: absolute;
  left: 50%;
  top: 50%;
  transform: translateX(-50%) translateY(-50%);

  .loader-icon {
    position: relative;
    height: $icon-side-length;

    margin-bottom: 8px;
  }

  // Spinning borders
  .loader-icon__borders-container {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);

    width: $icon-side-length;
    height: $icon-side-length;
  }

  .loader-icon__borders-container__borders {
    width: 100%;
    height: 100%;

    border-radius: 50%;
    border: ($icon-side-length * 0.025) solid transparent;
    border-top-color: $outer-border-color;

    animation: spin 1.2s linear infinite;
  }

  .loader-icon__borders-container__borders:before {
    content: '';

    position: absolute;
    top: $icon-side-length * 0.05;
    right: $icon-side-length * 0.05;
    bottom: $icon-side-length * 0.05;
    left: $icon-side-length * 0.05;

    border-radius: 50%;
    border: ($icon-side-length * 0.025) solid transparent;
    border-top-color: $inner-border-color;

    animation: spin 1.2s $loader-bezier infinite;
  }
  
  // Masthead icon
  .loader-icon__svg {
    display: block;
    height: 35%;

    position: absolute;
    left: 50%;
    top: 50%;
    transform: translateX(-50%) translateY(-50%);

    color: $icon-color;
  }

  // Message
  .loader-message {
    @include fonts__sans-serif;
    font-weight: 700;
    text-align: center;
    color: $text-color;

    margin-bottom: 0;
  }

  // Retry button
  .loader-retry {
    display: none;

    text-align: center;
  }

  .loader-retry__button {
    @include button($button-size, $button-size-rules, $button-style, $button-can-load);
    text-transform: initial;
  }

  // Error state (show 'Retry button')
  &.is--in-error {

    .loader-icon {
      display: none;
    }

    .loader-message { 
      margin-bottom: 16px;
    }

    .loader-retry {
      display: block;
    }
  }
}

// *---> Public mix-ins

/*
  Loader

  @param { String } style - String describing style of loader.
*/

@mixin loader($style: "standard") {

  @if ($style == "standard") {
    @include _loader();
  }

  @if ($style == "standard--dark") {
    @include _loader(
      80px,
      $color__athens-gray,
      #D0011B,
      $color__athens-gray,
      $color__athens-gray,
      "medium",
      "dynamic",
      "solid--reversed",
      false
    );
  }
}

/*
  Loader container
*/

@mixin loader-container() {
  position: relative;
}
